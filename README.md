# Modele Prédictif Prédire le Rendement de la Production

<div class="group/conversation-turn relative flex w-full min-w-0 flex-col agent-turn"><div class="flex-col gap-1 md:gap-3"><div class="flex max-w-full flex-col flex-grow"><div data-message-author-role="assistant" data-message-id="57d1c77a-dc19-442f-9ca8-0d749ceb4c8c" dir="auto" class="text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words [.text-message+&amp;]:mt-5" data-message-model-slug="gpt-4o-mini"><div class="flex w-full flex-col gap-1 empty:hidden first:pt-[3px]"><div class="markdown prose w-full break-words dark:prose-invert light"><h3><strong>Activité pratique : Création d’un modèle prédictif complet pour le domaine agroalimentaire</strong></h3><p><strong>Objectif</strong> : Prédire le <strong>rendement de la production</strong> dans une usine agroalimentaire à partir de différentes variables influençant la productivité. Le modèle utilisera des données simulées sur les conditions de production pour prédire le rendement de production (quantité produite en tonnes).</p><h4><strong>Contexte :</strong></h4><p>Imaginons que vous travaillez pour une usine agroalimentaire produisant des produits en grande quantité comme des biscuits, des boissons ou des produits laitiers. L’usine souhaite prédire le <strong>rendement de production</strong> sur une période donnée en fonction de plusieurs variables influençant la production, telles que :</p><ul><li><strong>Température (°C)</strong> : Température ambiante ou de cuisson.</li><li><strong>Humidité (%)</strong> : Humidité dans l'usine, qui peut influencer la production, notamment pour les produits sensibles.</li><li><strong>Vitesse de production (productions/heure)</strong> : La vitesse à laquelle la ligne de production fonctionne.</li><li><strong>Durée de production (heures)</strong> : Temps total pendant lequel l'usine fonctionne.</li><li><strong>Type de produit</strong> : Type de produit fabriqué (par exemple, biscuits, yaourts, etc.).</li></ul><p>Nous allons créer un modèle prédictif pour estimer le <strong>rendement de production</strong> en fonction de ces variables.</p><h4><strong>Durée de l'activité :</strong> 2 à 3 heures</h4><h4><strong>Prérequis :</strong></h4><ul><li>Python et les bibliothèques <code>pandas</code>, <code>numpy</code>, <code>matplotlib</code>, <code>seaborn</code>, <code>scikit-learn</code> installées.</li><li>Connaissances de base en <strong>Python</strong> et en <strong>apprentissage automatique</strong>.</li></ul><hr><h3><strong>Étapes de l’activité :</strong></h3><h4><strong>Étape 1 : Créer et explorer le jeu de données</strong></h4><p>Nous allons d’abord créer un jeu de données simulé, contenant les variables que nous allons utiliser pour prédire le rendement de production.</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># Création du jeu de données simulé</span>
data = {
    <span class="hljs-string">'Température (°C)'</span>: [<span class="hljs-number">22</span>, <span class="hljs-number">25</span>, <span class="hljs-number">24</span>, <span class="hljs-number">28</span>, <span class="hljs-number">30</span>, <span class="hljs-number">21</span>, <span class="hljs-number">23</span>, <span class="hljs-number">27</span>, <span class="hljs-number">26</span>, <span class="hljs-number">29</span>],
    <span class="hljs-string">'Humidité (%)'</span>: [<span class="hljs-number">60</span>, <span class="hljs-number">55</span>, <span class="hljs-number">65</span>, <span class="hljs-number">70</span>, <span class="hljs-number">80</span>, <span class="hljs-number">75</span>, <span class="hljs-number">68</span>, <span class="hljs-number">74</span>, <span class="hljs-number">69</span>, <span class="hljs-number">72</span>],
    <span class="hljs-string">'Vitesse de production (productions/heure)'</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">120</span>, <span class="hljs-number">110</span>, <span class="hljs-number">130</span>, <span class="hljs-number">140</span>, <span class="hljs-number">95</span>, <span class="hljs-number">105</span>, <span class="hljs-number">125</span>, <span class="hljs-number">115</span>, <span class="hljs-number">135</span>],
    <span class="hljs-string">'Durée de production (heures)'</span>: [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>],
    <span class="hljs-string">'Type de produit'</span>: [<span class="hljs-string">'Biscuits'</span>, <span class="hljs-string">'Biscuits'</span>, <span class="hljs-string">'Yaourts'</span>, <span class="hljs-string">'Yaourts'</span>, <span class="hljs-string">'Boissons'</span>, <span class="hljs-string">'Boissons'</span>, <span class="hljs-string">'Yaourts'</span>, <span class="hljs-string">'Boissons'</span>, <span class="hljs-string">'Biscuits'</span>, <span class="hljs-string">'Yaourts'</span>],
    <span class="hljs-string">'Rendement (tonnes)'</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>, <span class="hljs-number">16</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>]  <span class="hljs-comment"># Rendement en tonnes</span>
}

<span class="hljs-comment"># Charger les données dans un DataFrame</span>
df = pd.DataFrame(data)

<span class="hljs-comment"># Afficher les premières lignes du jeu de données</span>
<span class="hljs-built_in">print</span>(df.head())
</code></div></div></pre><p>Ce jeu de données contient 4 variables explicatives (Température, Humidité, Vitesse de production, Durée de production) et une variable cible (Rendement de production en tonnes).</p><hr><h4><strong>Étape 2 : Exploration des données</strong></h4><p>Avant d'entraîner le modèle, il est important d'explorer et de comprendre les données :</p><ol><li><strong>Vérification des dimensions du dataset :</strong></li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># Dimensions du dataset</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Dimensions du dataset : "</span>, df.shape)
</code></div></div></pre><ol start="2"><li><strong>Statistiques descriptives :</strong></li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># Statistiques descriptives</span>
<span class="hljs-built_in">print</span>(df.describe())
</code></div></div></pre><ol start="3"><li><strong>Vérification des valeurs manquantes :</strong></li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># Vérifier les valeurs manquantes</span>
<span class="hljs-built_in">print</span>(df.isnull().<span class="hljs-built_in">sum</span>())
</code></div></div></pre><ol start="4"><li><strong>Visualisation des relations entre les variables :</strong></li></ol><p>Pour mieux comprendre les relations entre les variables, nous pouvons utiliser des graphiques de dispersion.</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># Visualisation des relations entre les variables</span>
sns.pairplot(df, kind=<span class="hljs-string">'scatter'</span>, hue=<span class="hljs-string">'Type de produit'</span>)
plt.show()
</code></div></div></pre><hr><h4><strong>Étape 3 : Préparation des données pour l’entraînement</strong></h4><p>Nous devons convertir les variables catégorielles (comme "Type de produit") en variables numériques. Pour cela, nous utiliserons la méthode <strong>One-Hot Encoding</strong>. Ensuite, nous diviserons les données en ensembles d'entraînement et de test.</p><ol><li><strong>Encodage des variables catégorielles :</strong></li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># One-Hot Encoding pour la variable catégorielle "Type de produit"</span>
df_encoded = pd.get_dummies(df, columns=[<span class="hljs-string">'Type de produit'</span>], drop_first=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># Affichage des premières lignes du DataFrame encodé</span>
<span class="hljs-built_in">print</span>(df_encoded.head())
</code></div></div></pre><ol start="2"><li><strong>Séparation des variables explicatives et de la variable cible :</strong></li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># Séparer les variables explicatives (features) et la variable cible (target)</span>
X = df_encoded.drop(columns=[<span class="hljs-string">'Rendement (tonnes)'</span>])
y = df_encoded[<span class="hljs-string">'Rendement (tonnes)'</span>]

<span class="hljs-comment"># Diviser les données en ensemble d'entraînement (80%) et ensemble de test (20%)</span>
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)

<span class="hljs-comment"># Vérification des dimensions après séparation</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Dimensions d'entraînement : "</span>, X_train.shape, y_train.shape)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Dimensions de test : "</span>, X_test.shape, y_test.shape)
</code></div></div></pre><hr><h4><strong>Étape 4 : Entraînement du modèle</strong></h4><p>Pour prédire un rendement en tonnes, nous allons utiliser un modèle de <strong>régression linéaire</strong>, car il s'agit d'un problème de régression (prédire une valeur continue).</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression

<span class="hljs-comment"># Créer et entraîner le modèle de régression linéaire</span>
model = LinearRegression()
model.fit(X_train, y_train)

<span class="hljs-comment"># Afficher les coefficients du modèle</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Coefficients du modèle : "</span>, model.coef_)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Intercept du modèle : "</span>, model.intercept_)
</code></div></div></pre><hr><h4><strong>Étape 5 : Évaluation du modèle</strong></h4><p>Une fois le modèle entraîné, nous allons effectuer des prédictions sur l'ensemble de test et évaluer sa performance à l'aide de l'erreur quadratique moyenne (MSE) et de la <strong>r2</strong> (coefficient de détermination).</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error, r2_score

<span class="hljs-comment"># Faire des prédictions sur l'ensemble de test</span>
y_pred = model.predict(X_test)

<span class="hljs-comment"># Calculer l'erreur quadratique moyenne (MSE)</span>
mse = mean_squared_error(y_test, y_pred)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Erreur quadratique moyenne (MSE) : "</span>, mse)

<span class="hljs-comment"># Calculer le coefficient de détermination R2</span>
r2 = r2_score(y_test, y_pred)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Coefficient de détermination R2 : "</span>, r2)
</code></div></div></pre><p><strong>Interprétation :</strong></p><ul><li>Un <strong>MSE faible</strong> indique que le modèle fait de bonnes prédictions.</li><li>Le <strong>R2</strong> est une mesure de la qualité de l'ajustement. Un R2 proche de 1 indique que le modèle explique bien la variabilité des données.</li></ul><hr><h4><strong>Étape 6 : Visualisation des résultats</strong></h4><p>Il est toujours utile de visualiser les prédictions pour comprendre la performance du modèle. Utilisez un graphique de type <strong>scatter plot</strong> pour comparer les valeurs réelles avec les valeurs prédites.</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># Visualisation des résultats</span>
plt.scatter(y_test, y_pred)
plt.xlabel(<span class="hljs-string">'Valeurs réelles'</span>)
plt.ylabel(<span class="hljs-string">'Valeurs prédites'</span>)
plt.title(<span class="hljs-string">'Rendement réel vs prédit'</span>)
plt.show()
</code></div></div></pre><p><strong>Interprétation :</strong></p><ul><li>Si les points sont proches de la ligne diagonale (45°), cela signifie que le modèle a une bonne précision.</li><li>Si les points sont dispersés, cela suggère que le modèle n'est pas performant.</li></ul><hr><h4><strong>Étape 7 : Améliorations possibles</strong></h4><p>Si la performance du modèle n'est pas satisfaisante, plusieurs améliorations peuvent être envisagées :</p><ol><li><p><strong>Ajouter de nouvelles fonctionnalités</strong> :</p><ul><li><strong>Type d’ingrédients</strong> (par exemple, des ingrédients spécifiques peuvent affecter le rendement).</li><li><strong>Conditions météorologiques externes</strong> (si les usines sont sensibles aux conditions extérieures).</li><li><strong>Historique de production</strong> (informations sur les performances passées de la production).</li></ul></li><li><p><strong>Essayer d'autres modèles</strong> :</p><ul><li><strong>Arbres de décision</strong> ou <strong>forêts aléatoires</strong> pour capturer des relations non linéaires.</li><li><strong>Régression Ridge/Lasso</strong> pour traiter des problèmes de multicolinéarité.</li><li><strong>Réseaux neuronaux</strong> pour des modèles plus complexes, mais qui nécessitent plus de données et de puissance de calcul.</li></ul></li></ol><p><strong>Exemple pour un modèle de forêt aléatoire :</strong></p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestRegressor

<span class="hljs-comment"># Créer et entraîner un modèle de forêt aléatoire</span>
rf_model = RandomForestRegressor(n_estimators=<span class="hljs-number">100</span>, random_state=<span class="hljs-number">42</span>)
rf_model.fit(X_train, y_train)

<span class="hljs-comment"># Faire des prédictions avec le modèle de forêt aléatoire</span>
y_rf_pred = rf_model.predict(X_test)

<span class="hljs-comment"># Évaluer le modèle</span>
rf_mse = mean_squared_error(y_test, y_rf_pred)
rf_r2 = r2_score(y_test, y_rf_pred)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Forêt Aléatoire - MSE : "</span>, rf_mse)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Forêt Aléatoire - R2 : "</span>, rf_r2)
</code></div></div></pre><hr><h3><strong>Conclusion :</strong></h3><p>Dans cette activité, nous avons créé un modèle prédictif pour prédire le rendement de production dans le secteur agroalimentaire. Nous avons exploré les données, préparé les caractéristiques pour l’entraînement, créé un modèle de régression linéaire, et évalué ses performances. Ensuite, nous avons suggéré des pistes d’améliorations pour optimiser le modèle et améliorer ses performances.</p></div></div></div></div><div class="mb-2 flex gap-3 empty:hidden -ml-2"><div class="items-center justify-start rounded-xl p-1 z-10 -mt-1 bg-token-main-surface-primary md:absolute md:sr-only"><div class="flex items-center"><span class="" data-state="closed"><button class="rounded-lg text-token-text-secondary hover:bg-token-main-surface-secondary" aria-label="Copier" data-testid="copy-turn-action-button"><span class="flex h-[30px] w-[30px] items-center justify-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-md-heavy"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg></span></button></span><span class="hidden"></span><button class="cursor-pointer h-[30px] rounded-md px-1 text-token-text-secondary hover:bg-token-main-surface-secondary"><div class="flex items-center pb-0"><span class="overflow-hidden text-clip whitespace-nowrap text-sm" style="opacity: 0; padding-left: 0px; width: 0px; will-change: opacity;">Bon Travail</span></div></button></div></div></div><div class="pr-2 lg:pr-0"></div></div></div>
